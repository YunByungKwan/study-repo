# 17장. Money 회고

> 이 장에서 이야기할 것
>
> - 다음에 할일은 무엇인가
> - 메타포 - 설계 구조에 미치는 메타포의 엄청난 영향
> - JUnit 사용도 - 언제 테스트를 실행했으며, JUnit을 어떻게 사용해 왔는가
> - 코드 메트릭스(metrics) - 결과 코드의 수치화
> - 프로세스 - 빨강/초록/리팩토링 순서에 대해 이야기했는데, 그렇다면 각 단계에서 얼마 만큼 작업해야 하는가
> - 테스트의 질 - 전통적인 테스트 메트릭스에 TDD 테스트가 어떻게 필적할 수 있는가.



### 다음에 할일은 무엇인가

- 아직 Sum.plus()와 Money.plus() 사이에 지저분한 중복이 남았다.

  -> Expression을 인터페이스 대신 클래스로 바꾼다면 공통되는 코드를 담아낼 적절한 곳이 될 것

- 어떤 테스트들이 추가로 더 필요할 지 생각해야 한다.

- 지금까지 설계한 것을 검토하는 시간을 갖자.



### 메타포 - 설계 구조에 미치는 메타포의 엄청난 영향

- 지금까지 사용했던 메타포(MoneySum, MoneyBag, Wallet) 

  -> <u>Money의 집합이 딱 떨어지는 숫자로 된다는 것을 암시</u>

- Expression 메타포 - 중복되는 통화를 합치는 세세한 일단의 문제에서 해방시켜 줌

=> <B>여러 번 코딩을 하다 보니 강력한 메타포들을 생각해낼 수 있었다?</B>



### JUnit 사용도 - 언제 테스트를 실행했으며, JUnit을 어떻게 사용해 왔는가

책 참고



### 코드 메트릭스(metrics) - 결과 코드의 수치화

표 17.1 코드 메트릭스

||실제 코드|테스트 코드|

|:---:|:---:|:---:|

|클래스|5|1|

|함수 (1)|22|15|

|줄 (2)|91|89|

|회기성 복잡도 (3)|1.04|1|

|함수당 줄|4.1 (4)|5.9 (5)|



(1) 코드와 테스트 코드 사이 대략 비슷한 양의 함수와 줄이 있다.

(2) 테스트 코드의 줄 수는 공통된 테스트 픽스처(?)를 뽑아내는 작업을 통해 줄일 수 있음. 하지만 비율은 비슷할 듯

(3) 회기성 복잡도 = 기존의 흐름 복잡도

- 테스트 복잡도: 1 (분기나 반복문이 없기 때문)
- 실제 코드 복잡도: 1.04 (다형성을 주로 사용했기 때문에 낮음)

(4) 함수의 선언부와 닫는 괄호도 포함된 줄 수

(5) 공통된 픽스처(?) 구축 코드를 추출하지 않았기 때문에 조금 과장되었음



### 프로세스 - 빨강/초록/리팩토링 순서에 대해 이야기했는데, 그렇다면 각 단계에서 얼마 만큼 작업해야 하는가

#### TDD의 주기

- 작은 테스트를 추가한다.
- 모든 테스트를 실행하고, 실패하는 것을 확인한다.
- 코드에 변화를 준다.
- 모든 테스트를 실행하고, 성공하는 것을 확인한다.
- 중복을 제거하기 위해 리팩토링한다.



![Leptokurtic (or platykurtic) degree difference of curves with different...  | Download Scientific Diagram](https://www.researchgate.net/profile/Yang-Wu-46/publication/303770982/figure/fig6/AS:613520190214153@1523286020558/Leptokurtic-or-platykurtic-degree-difference-of-curves-with-different-kurtosis.png)



### 테스트의 질 - 전통적인 테스트 메트릭스에 TDD 테스트가 어떻게 필적할 수 있는가.

TDD의 부산물로 생기는 테스트들은 유용하지만 아래 테스트들을 대체할 수 있다고 생각하면 안된다.

- 성능 테스트
- 스트레스 테스트
- 사용성 테스트



#### 위의 테스트 에 대해 널리 사용되는 지표

- 명령문 커버리지 - 테스트의 시작점
- 결함 삽입 - 코드의 의미를 바꾼 후에 테스트가 실패하는지 보는 것



#### 테스트 커버리지 by 플립

- 전체 커버리지 수치 = 프로그램의 서로 다른 경우를 테스트한 수 / 테스팅이 필요한 경우의 수

- 테스트 커버리지를 향상시키는 방법? 더 많은 테스트를 작성 or 프로그램 로직을 단순화



#### 최종 검토

TDD를 가르칠  때 사람들이 자주 놀라는 세 가지

- 테스트를 확실히 돌아가게 만드는 세 가지 접근법: 가짜로 구현하기, 삼각측량법, 명백하게 구현하기

- 설계를 주도하기 위한 방법으로 테스틑 코드와 실제 코드 사이의 중복을 제거하기
- 길이 미끄러우면 속도를 줄이고 상황이 좋으면 속도를 높이는 식으로 테스트 사이의 간격을 조절할 수 있는 능력